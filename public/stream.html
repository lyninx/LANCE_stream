<!DOCTYPE HTML>
<html>
	<head>
		<title>LANWAR X Stream Administration</title>
	    <link rel='shortcut icon' href='' />
	    <link rel='stylesheet' type='text/css' href='css/stream.css' />
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.js"></script>
	</head>
	<body>
	<div id="main">
		<div class="content">

	    	<ul id="messages"></ul>
		</div>
	</div>
	<script src="/socket.io/socket.io.js"></script>
	<script>
		function addZero(i) {
		    if (i < 10) {
		        i = "0" + i;
		    }
		    return i;
		}

	  var div = document.getElementById('messages');
	  var log = [];
	  // load previous chat messages ////////////////////////////////////////

	  var socket = io();
	  $('#socket-form').submit(function(){
	  	var d = new Date();
	  	var t = d.getHours() +':'+ addZero(d.getMinutes());
	  	console.log(t);
	    socket.emit('chatmessage',{time: t, text: $('#m').val()});
	    $('#m').val('');
	    return false;
	  });

	  socket.on('chatmessage', function(msg){
	    var filteredText = msg.text.trim();
	    if(filteredText.length == 0){
	      // empty strings
	    } else {
	      var chatmsg = '<li class="shadow"><span>'+msg.time+'</span> '+msg.text+'</li>';
	     $('#messages').prepend(chatmsg);

	   }
	  });

	</script>
	</body>
</html>